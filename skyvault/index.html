<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyVault | Cloud Portal</title>
    <!-- Fonts and Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-pink: #FFD1DC;
            --bg-blue: #B3E5FC;
            --bg-lavender: #E1BEE7;
            --pastel-primary: #FF9AA2;
            --pastel-secondary: #B5EAD7;
            --pastel-accent: #C7CEEA;
            --text-main: #6D5D6E;
            --glass-bg: rgba(255, 255, 255, 0.45);
            --glass-border: rgba(255, 255, 255, 0.7);
            --heading-gradient: linear-gradient(135deg, #FF70A6 0%, #BA68C8 100%);
            --header-pastel: #BA68C8; 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Urbanist', sans-serif; }

        body {
            min-height: 100vh;
            background: linear-gradient(-45deg, var(--bg-pink), var(--bg-blue), var(--bg-lavender), #FFF9C4);
            background-size: 400% 400%;
            animation: gradientMove 15s ease infinite;
            color: var(--text-main);
            overflow: hidden;
        }

        @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .sparkles { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; 
            pointer-events: none; background-image: radial-gradient(circle, #fff 1px, transparent 1px); 
            background-size: 50px 50px; opacity: 0.3; 
        }

        /* --- SCREEN MANAGEMENT --- */
        .screen { 
            min-height: 100vh; 
            width: 100%; 
            display: none; 
            flex-direction: column; 
            align-items: center; 
        }

        #login-screen { display: flex; justify-content: center; }

        /* --- ANIMATIONS --- */
        @keyframes fadeInSlideUp { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        @keyframes fadeOutDown {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-15px); }
        }

        .soft-fade { animation: fadeInSlideUp 0.8s cubic-bezier(0.19, 1, 0.22, 1) forwards; }
        .fade-out { animation: fadeOutDown 0.4s ease forwards !important; }

        /* --- LOGIN SCREEN --- */
        .login-card {
            background: var(--glass-bg); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border); border-radius: 40px; padding: 50px 40px;
            width: 90%; max-width: 420px; box-shadow: 0 20px 40px rgba(0,0,0,0.05);
            text-align: center; z-index: 10;
        }
        .login-card h1 { 
            font-size: 42px; font-weight: 800; 
            background: var(--heading-gradient); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
            margin-bottom: 5px; 
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.05));
        }
        .login-card p { margin-bottom: 30px; font-weight: 600; opacity: 0.8; font-size: 14px; }
        
        .input-group { margin-bottom: 20px; text-align: left; }
        .input-label { display: block; font-weight: 700; font-size: 14px; margin-bottom: 8px; color: var(--text-main); margin-left: 15px; }
        .input-field {
            width: 100%; padding: 16px 25px; background: rgba(255,255,255,0.6); 
            border: 2px solid transparent; border-radius: 50px; outline: none; 
            color: var(--text-main); font-weight: 600; transition: 0.3s;
        }
        .input-field:focus { border-color: var(--pastel-primary); background: #fff; box-shadow: 0 0 10px rgba(255,209,220,0.3); }

        .btn-primary {
            width: 100%; padding: 18px; border: none; border-radius: 50px; 
            background: linear-gradient(45deg, #FFB7B2, #E2F0CB, #B2E2F2);
            background-size: 200% 200%;
            color: var(--text-main); font-size: 18px; font-weight: 800; cursor: pointer;
            box-shadow: 0 10px 20px rgba(255,183,178,0.2); transition: 0.3s;
        }
        .btn-primary:hover { transform: scale(1.05); background-position: right center; }
        #login-error { color: #FF8A8A; font-size: 13px; font-weight: 700; margin-bottom: 15px; display: none; }

        /* --- DASHBOARD SCREEN --- */
        #dashboard-screen { padding: 40px 20px; overflow-y: auto; }
        .container { width: 100%; max-width: 800px; position: relative; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; position: relative; }
        .brand h1 { 
            font-size: 32px; font-weight: 800; 
            background: var(--heading-gradient); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
        }
        .brand p { font-size: 12px; font-weight: 600; opacity: 0.7; margin-top: -2px; }
        .dashboard-header-text { font-size: 18px; font-weight: 800; color: var(--header-pastel); margin-bottom: 15px; margin-top: 10px; }

        /* Options Menu (Three Dots) */
        .options-menu { position: relative; }
        .options-trigger {
            background: none; border: none; font-size: 24px; color: var(--text-main);
            cursor: pointer; padding: 10px; border-radius: 50%; transition: 0.3s;
            display: flex; align-items: center; justify-content: center;
        }
        .options-trigger:hover { background: rgba(255,255,255,0.3); }
        .options-dropdown {
            position: absolute; right: 0; top: 100%; background: white; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: none; flex-direction: column;
            z-index: 500; width: 180px; overflow: hidden; border: 1px solid var(--glass-border);
            margin-top: 5px; animation: fadeInSlideUp 0.3s ease;
        }
        .options-dropdown.active { display: flex; }
        .options-item {
            padding: 15px 20px; font-size: 14px; font-weight: 700; cursor: pointer;
            transition: 0.2s; text-align: left; background: none; border: none;
            color: var(--text-main); display: flex; align-items: center; gap: 10px;
        }
        .options-item:hover { background: var(--bg-pink); }
        .options-item i { width: 16px; text-align: center; }

        /* Action Bar */
        .action-bar {
            display: flex; justify-content: center; gap: 12px; margin-bottom: 20px;
        }
        .bar-btn {
            padding: 10px 20px; border-radius: 50px; border: 2px solid var(--glass-border);
            background: var(--glass-bg); color: var(--text-main); font-weight: 800; font-size: 13px;
            cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 8px;
        }
        .bar-btn:hover { background: #fff; transform: translateY(-2px); border-color: var(--pastel-primary); }

        /* Upload Box */
        .upload-box {
            background: var(--glass-bg); backdrop-filter: blur(25px); border: 2px solid var(--glass-border);
            border-radius: 35px; padding: 40px; text-align: center; margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.03);
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .upload-box:hover { 
            box-shadow: 0 0 25px 8px rgba(255, 154, 162, 0.25); 
            transform: translateY(-5px) scale(1.01);
        }
        .upload-icon { font-size: 45px; color: var(--pastel-primary); margin-bottom: 15px; }

        /* File List */
        .file-list { display: grid; grid-template-columns: 1fr; gap: 12px; width: 100%; margin-top: 10px; padding-bottom: 80px; }
        .file-item {
            background: rgba(255,255,255,0.7); border-radius: 20px; padding: 15px 20px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 8px 15px rgba(0,0,0,0.02); transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: fadeInSlideUp 0.6s cubic-bezier(0.19, 1, 0.22, 1) forwards;
        }
        .file-item:hover { 
            transform: translateX(8px) translateY(-3px); 
            background: #fff; 
            box-shadow: 0 12px 25px rgba(255, 154, 162, 0.15);
        }
        .file-info { display: flex; align-items: center; gap: 12px; min-width: 0; }
        .file-icon { width: 42px; height: 42px; border-radius: 12px; background: #FFD1DC; color: #FF9AA2; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; }
        .file-details { min-width: 0; }
        .file-name-text { font-weight: 800; font-size: 15px; color: var(--text-main); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: block; }
        .file-size-text { font-size: 12px; font-weight: 700; color: #A0939F; }

        .file-checkbox {
            width: 20px; height: 20px; cursor: pointer; accent-color: var(--pastel-primary);
            margin-right: 15px; transition: 0.3s;
        }

        .file-actions { display: flex; gap: 8px; }
        .btn-action { padding: 8px 15px; border-radius: 50px; border: none; font-weight: 800; font-size: 12px; cursor: pointer; transition: 0.2s; }
        .btn-open { background: var(--pastel-secondary); color: #4CAF50; }
        .btn-open:hover { transform: scale(1.1); box-shadow: 0 4px 10px rgba(76, 175, 80, 0.2); }

        .header-actions { display: flex; align-items: center; gap: 10px; }
        .logout-btn { padding: 10px 20px; border-radius: 50px; background: #fff; border: 2px solid var(--glass-border); font-weight: 800; cursor: pointer; transition: 0.2s; }
        .logout-btn:hover { background: #FFD1DC; transform: scale(1.05); }

        /* Floating Upload Button */
        .floating-upload {
            position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px;
            background: linear-gradient(135deg, #FF9AA2, #C7CEEA); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; color: white;
            font-size: 24px; cursor: pointer; box-shadow: 0 10px 30px rgba(255, 154, 162, 0.4);
            z-index: 100; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .floating-upload:hover { transform: scale(1.15) rotate(90deg); box-shadow: 0 15px 35px rgba(255, 154, 162, 0.6); }

    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div class="sparkles"></div>

    <!-- Screen 1: Login -->
    <section id="login-screen" class="screen">
        <div class="login-card">
            <i class="fa-solid fa-cloud" style="font-size: 40px; color: #FF9AA2; margin-bottom: 10px;"></i>
            <h1>SkyVault</h1>
            <p>Where your files feel safe, calm and beautifully organized.</p>
            <form id="loginForm">
                <div class="input-group">
                    <label class="input-label">Username</label>
                    <input type="text" id="username" class="input-field" placeholder="Enter your username" required>
                </div>
                <div class="input-group">
                    <label class="input-label">Password</label>
                    <input type="password" id="password" class="input-field" placeholder="Enter your password" required>
                </div>
                <div id="login-error">Both fields are required to enter.</div>
                <button type="submit" class="btn-primary">Open Vault <i class="fa-solid fa-key"></i></button>
            </form>
        </div>
    </section>

    <!-- Screen 2: Dashboard -->
    <section id="dashboard-screen" class="screen">
        <div class="container">
            <header>
                <div class="brand">
                    <h1>SkyVault</h1>
                    <p>Where your files feel safe, calm and beautifully organized.</p>
                </div>
                <div class="header-actions">
                    <button class="logout-btn" onclick="logout()">
                        <i class="fa-solid fa-power-off"></i> Logout
                    </button>
                    <!-- Three Dots Menu -->
                    <div class="options-menu">
                        <button class="options-trigger" id="options-trigger" onclick="toggleOptionsMenu()">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <div class="options-dropdown" id="options-dropdown">
                            <button class="options-item" onclick="toggleSelectMode()">
                                <i class="fas fa-check-square"></i> <span id="select-mode-text">Select Files</span>
                            </button>
                            <button class="options-item" onclick="deleteSelectedFiles()" id="delete-selected-btn" style="display: none;">
                                <i class="fas fa-trash-alt"></i> Delete Selected
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <div class="dashboard-header-text">Dashboard</div>

            <div class="action-bar">
                <button class="bar-btn" onclick="triggerPicker()">
                    <i class="fa-solid fa-cloud-arrow-up"></i> Upload
                </button>
                <button class="bar-btn" onclick="scrollToFiles()">
                    <i class="fa-solid fa-list-ul"></i> Files
                </button>
            </div>

            <div class="upload-box soft-fade" id="drop-area">
                <i class="fa-solid fa-cloud-arrow-up upload-icon"></i>
                <h2 style="font-weight: 800; margin-bottom: 10px;">Drop artifacts here</h2>
                <p style="opacity: 0.7; font-size: 14px; margin-bottom: 20px;">Synchronize files with your universal vault.</p>
                <button class="btn-primary" style="width: auto; padding: 12px 30px; font-size: 14px;" onclick="triggerPicker()">
                    Choose Artifacts
                </button>
                <input type="file" id="file-picker" style="display: none;" multiple>
            </div>

            <h3 id="files-heading" style="margin-bottom: 15px; font-weight: 800; display: flex; align-items: center; gap: 8px;">
                <i class="fa-solid fa-folder-open" style="color: #BA68C8;"></i> My Artifacts
            </h3>

            <div id="file-list" class="file-list">
                <!-- Dynamic File Items -->
            </div>
        </div>

        <div class="floating-upload" onclick="triggerPicker()" title="Quick Sync">
            <i class="fa-solid fa-plus"></i>
        </div>
    </section>

    <script>
        /**
         * Core Application Logic - SkyVault SPA
         * Removed History/Log system for a silent experience.
         */
        
        // Persistent State
        let filesData = JSON.parse(localStorage.getItem('skyvault_files_data') || '[]');
        let isSelectMode = false;
        let selectedIds = new Set();

        function saveState() {
            localStorage.setItem('skyvault_files_data', JSON.stringify(filesData));
        }

        // DOM Elements
        const loginForm = document.getElementById('loginForm');
        const loginScreen = document.getElementById('login-screen');
        const dashboardScreen = document.getElementById('dashboard-screen');
        const loginError = document.getElementById('login-error');
        const filePicker = document.getElementById('file-picker');
        const fileListContainer = document.getElementById('file-list');
        const dropArea = document.getElementById('drop-area');

        // --- Screen Switching Logic ---
        function switchToDashboard() {
            loginScreen.style.display = 'none';
            dashboardScreen.style.display = 'flex';
            renderFiles();
        }

        function switchToLogin() {
            loginScreen.style.display = 'flex';
            dashboardScreen.style.display = 'none';
        }

        // --- Authentication ---
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const user = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value.trim();

            if (user && pass) {
                sessionStorage.setItem('skyvault_logged_in', 'true');
                switchToDashboard();
            } else {
                loginError.style.display = 'block';
                setTimeout(() => { loginError.style.display = 'none'; }, 3000);
            }
        });

        function logout() {
            sessionStorage.removeItem('skyvault_logged_in');
            switchToLogin();
        }

        // --- Navigation & Menu ---
        function scrollToFiles() {
            document.getElementById('files-heading').scrollIntoView({ behavior: 'smooth' });
        }

        function toggleOptionsMenu() {
            document.getElementById('options-dropdown').classList.toggle('active');
        }

        window.addEventListener('click', (e) => {
            if (!e.target.closest('.options-menu')) {
                const dropdown = document.getElementById('options-dropdown');
                if (dropdown) dropdown.classList.remove('active');
            }
        });

        function toggleSelectMode() {
            isSelectMode = !isSelectMode;
            selectedIds.clear();
            document.getElementById('select-mode-text').innerText = isSelectMode ? 'Cancel Selection' : 'Select Files';
            document.getElementById('delete-selected-btn').style.display = isSelectMode ? 'flex' : 'none';
            document.getElementById('options-dropdown').classList.remove('active');
            renderFiles();
        }

        // --- File Management ---
        function triggerPicker() {
            filePicker.click();
        }

        filePicker.addEventListener('change', (e) => {
            handleFileSelection(e.target.files);
            filePicker.value = ''; 
        });

        function formatSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function handleFileSelection(files) {
            if (!files || files.length === 0) return;

            for (let f of files) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const fileObj = {
                        id: 'f_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5),
                        name: f.name,
                        size: formatSize(f.size),
                        data: event.target.result, 
                        type: f.type,
                        timestamp: Date.now()
                    };
                    filesData.unshift(fileObj);
                    saveState();
                    renderFiles();
                };
                reader.readAsDataURL(f);
            }
        }

        function renderFiles() {
            fileListContainer.innerHTML = '';
            
            if (filesData.length === 0) {
                fileListContainer.innerHTML = `
                    <div style="text-align: center; padding: 40px; opacity: 0.4;">
                        <i class="fa-solid fa-inbox" style="font-size: 32px; margin-bottom: 8px;"></i>
                        <p>No artifacts synced yet.</p>
                    </div>
                `;
                return;
            }

            filesData.forEach(file => {
                const item = document.createElement('div');
                item.className = 'file-item';
                item.id = file.id;
                item.setAttribute('data-id', file.id);
                
                const checkboxHtml = isSelectMode ? `<input type="checkbox" class="file-checkbox" onchange="toggleFileSelection('${file.id}')" ${selectedIds.has(file.id) ? 'checked' : ''}>` : '';
                
                item.innerHTML = `
                    <div class="file-info">
                        ${checkboxHtml}
                        <div class="file-icon"><i class="fa-solid fa-file"></i></div>
                        <div class="file-details">
                            <span class="file-name-text">${file.name}</span>
                            <span class="file-size-text">${file.size}</span>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="btn-action btn-open" onclick="openFile('${file.id}')">Open</button>
                    </div>
                `;
                fileListContainer.appendChild(item);
            });
        }

        function toggleFileSelection(id) {
            if (selectedIds.has(id)) {
                selectedIds.delete(id);
            } else {
                selectedIds.add(id);
            }
        }

        function openFile(id) {
            const file = filesData.find(f => f.id === id);
            if (!file || !file.data) return;

            try {
                const parts = file.data.split(';base64,');
                const contentType = parts[0].split(':')[1];
                const raw = window.atob(parts[1]);
                const rawLength = raw.length;
                const uInt8Array = new Uint8Array(rawLength);

                for (let i = 0; i < rawLength; ++i) {
                    uInt8Array[i] = raw.charCodeAt(i);
                }

                const blob = new Blob([uInt8Array], { type: contentType });
                const blobUrl = URL.createObjectURL(blob);
                window.open(blobUrl, '_blank');
                setTimeout(() => URL.revokeObjectURL(blobUrl), 15000);
            } catch (err) {
                window.open(file.data, '_blank');
            }
        }

        function deleteSelectedFiles() {
            const checkboxes = document.querySelectorAll('.file-checkbox:checked');
            if (checkboxes.length === 0) return;

            if (confirm(`Remove ${checkboxes.length} selected artifact(s)?`)) {
                const idsToRemove = Array.from(checkboxes).map(cb => {
                    const card = cb.closest('.file-item');
                    return card ? card.getAttribute('data-id') : null;
                }).filter(id => id !== null);

                idsToRemove.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) element.classList.add('fade-out');
                });

                setTimeout(() => {
                    filesData = filesData.filter(file => !idsToRemove.includes(file.id));
                    saveState();
                    
                    isSelectMode = false;
                    selectedIds.clear();
                    
                    document.getElementById('select-mode-text').innerText = 'Select Files';
                    document.getElementById('delete-selected-btn').style.display = 'none';
                    document.getElementById('options-dropdown').classList.remove('active');
                    
                    renderFiles();
                }, 400);
            }
        }

        // --- Drag and Drop ---
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eName => {
            dropArea.addEventListener(eName, (e) => { e.preventDefault(); e.stopPropagation(); }, false);
        });

        ['dragenter', 'dragover'].forEach(eName => {
            dropArea.addEventListener(eName, () => dropArea.style.borderColor = 'var(--pastel-primary)', false);
        });

        ['dragleave', 'drop'].forEach(eName => {
            dropArea.addEventListener(eName, () => dropArea.style.borderColor = 'var(--glass-border)', false);
        });

        dropArea.addEventListener('drop', (e) => {
            handleFileSelection(e.dataTransfer.files);
        });

        // --- Init Functionality ---
        window.addEventListener('load', () => {
            document.getElementById('login-screen').style.display = 'flex';
            document.getElementById('dashboard-screen').style.display = 'none';

            if (sessionStorage.getItem('skyvault_logged_in') === 'true') {
                switchToDashboard();
            }
        });
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>